<?xml version="1.0" ?>

<project name="shows" default="converter" basedir=".">

<!--	This assumes that jwsdp is installed at /usr/local/jwsdp-1.3/ 
		Otherwise can be set with "ant -Djwsdp.home=..." -->

<property name="jwsdp.home" value="/usr/local/jwsdp-1.3" />

<path id="classpath">
	<pathelement path="." />
	<!-- for use with bundled ant -->
	<fileset dir="${jwsdp.home}" includes="jaxb/lib/*.jar" />
	<fileset dir="${jwsdp.home}" includes="jwsdp-shared/lib/*.jar" />
	<fileset dir="${jwsdp.home}" includes="jaxp/lib/**/*.jar" />
</path>

<taskdef name="xjc" classname="com.sun.tools.xjc.XJCTask">
	<classpath refid="classpath" />
</taskdef>
	
<property name="src.dir" value="src" />
<property name="dist.dir" value="dist" />

<property name="build.dir" value="build" />
<property name="build.classes" value="${build.dir}/classes" />
<property name="build.lib" value="${build.dir}/lib" />
<property name="build.gensrc" value="${build.dir}/gensrc" />

<property name="javac.debug" value="no" />

<target name="clean">
	<delete dir="${build.dir}" />
</target>

<target name="prepare">
	<tstamp/>
	<mkdir dir="${build.dir}" />
	<mkdir dir="${build.classes}" />
	<mkdir dir="${build.lib}" />
	<mkdir dir="${build.gensrc}" />
</target>

<target name="jaxb" depends="prepare">
	<xjc schema="xml/music.xsd" target="${build.gensrc}" package="com.bolsinga.music.data"/>
	<javac  destdir="${build.classes}"
			debug="${javac.debug}"
			deprecation="on">
		<src path="${build.gensrc}" />
		<include name="com/bolsinga/music/**" />
		<classpath refid="classpath" />
	</javac>
	<copy todir="${build.classes}">
		<fileset dir="${build.gensrc}" >
			<exclude name="**/*.java" />
		</fileset>
	</copy>
</target>

<target name="converter" depends="jaxb">
	<javac	destdir="${build.classes}"
			debug="${javac.debug}"
			deprecation="on">
		<src path="${src.dir}" />
		<include name="com/bolsinga/shows/converter/**" />
		<classpath refid="classpath" />
	</javac>
</target>

<target name="music" depends="converter">
	<jar jarfile="${build.lib}/music.jar"
		basedir="${build.classes}" >
		<include name="com/bolsinga/**" />
		<manifest>
			<attribute name="Main-Class" value="com.bolsinga.shows.converter.Music" />
		</manifest>
	</jar>
</target>

</project>
